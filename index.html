<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<title>Controle de Estoque</title>
<meta name="theme-color" content="#1f2937">

<style>
  :root{
    --bg:#1f2937;--card:#374151;--fg:#f9fafb;
    --temos:#10b981;--acabando:#ef4444;--muted:#9ca3af;
  }
  *{box-sizing:border-box}
  body{
    margin:0;font-family:system-ui,-apple-system,sans-serif;
    background:var(--bg);color:var(--fg);
  }
  
  header{
    background:var(--card);padding:16px;text-align:center;
    border-bottom:1px solid #4b5563;
  }
  .title{font-size:1.2rem;font-weight:700;margin-bottom:4px}
  .subtitle{font-size:0.9rem;color:var(--muted)}
  
  .container{max-width:600px;margin:0 auto;padding:16px}
  
  .add-section{
    background:var(--card);border-radius:12px;padding:16px;margin-bottom:20px;
  }
  .add-input{
    width:100%;padding:12px;border:1px solid #6b7280;
    border-radius:8px;background:#1f2937;color:var(--fg);
    font-size:1rem;margin-bottom:12px;
  }
  .add-input:focus{outline:none;border-color:var(--temos)}
  .add-btn{
    width:100%;padding:12px;background:var(--temos);
    border:none;border-radius:8px;color:white;
    font-weight:600;font-size:1rem;cursor:pointer;
  }
  
  .filter-section{
    display:flex;gap:12px;margin-bottom:20px;
  }
  .filter-btn{
    flex:1;padding:10px;border:2px solid #4b5563;
    border-radius:8px;background:transparent;color:var(--fg);
    cursor:pointer;font-weight:500;
  }
  .filter-btn.active{background:var(--temos);border-color:var(--temos);color:white}
  .filter-btn.acabando-filter.active{background:var(--acabando);border-color:var(--acabando)}
  
  .items-list{display:grid;gap:8px}
  .item{
    background:var(--card);border-radius:12px;padding:16px;
    display:flex;justify-content:space-between;align-items:center;
    cursor:pointer;border:2px solid transparent;
    transition:all 0.2s ease;
  }
  .item:hover{border-color:#6b7280}
  .item.temos{border-left:4px solid var(--temos)}
  .item.acabando{border-left:4px solid var(--acabando)}
  
  .item-name{font-weight:500;font-size:1.1rem}
  .item-status{
    padding:6px 12px;border-radius:20px;font-size:0.85rem;
    font-weight:600;
  }
  .status-temos{background:var(--temos);color:white}
  .status-acabando{background:var(--acabando);color:white}
  
  .delete-btn{
    background:none;border:none;color:#9ca3af;
    cursor:pointer;font-size:1.2rem;margin-left:12px;
  }
  .delete-btn:hover{color:var(--acabando)}
  
  .stats{
    display:flex;gap:16px;margin-bottom:20px;text-align:center;
  }
  .stat{flex:1;background:var(--card);padding:12px;border-radius:8px}
  .stat-num{font-size:1.5rem;font-weight:700;margin-bottom:4px}
  .stat-label{font-size:0.8rem;color:var(--muted)}
  .stat-temos{color:var(--temos)}
  .stat-acabando{color:var(--acabando)}
  
  .empty{
    text-align:center;padding:40px;color:var(--muted);
  }
  
  .toast{
    position:fixed;bottom:20px;left:50%;transform:translateX(-50%);
    background:#374151;color:var(--fg);padding:12px 20px;
    border-radius:8px;opacity:0;transition:opacity 0.3s;
    z-index:1000;
  }
  .toast.show{opacity:1}
</style>
</head>

<body>
<header>
  <div class="title">üè† Controle de Estoque</div>
  <div class="subtitle">Toque para alterar o status dos itens</div>
</header>

<div class="container">
  <div class="add-section">
    <input id="newItem" class="add-input" placeholder="Adicionar novo item (ex: Detergente)" maxlength="50">
    <button id="addBtn" class="add-btn">Adicionar Item</button>
  </div>
  
  <div class="stats">
    <div class="stat">
      <div class="stat-num stat-temos" id="temosCount">0</div>
      <div class="stat-label">Temos</div>
    </div>
    <div class="stat">
      <div class="stat-num stat-acabando" id="acabandoCount">0</div>
      <div class="stat-label">Acabando</div>
    </div>
  </div>
  
  <div class="filter-section">
    <button class="filter-btn active" data-filter="all">Todos os Itens</button>
    <button class="filter-btn acabando-filter" data-filter="acabando">Precisa Comprar</button>
  </div>
  
  <div id="itemsList" class="items-list"></div>
  
  <div id="emptyState" class="empty" style="display:none">
    Nenhum item encontrado.<br>
    Adicione itens que voc√™s sempre mant√™m em casa.
  </div>
</div>

<div id="toast" class="toast"></div>

<script>
// Items padr√£o para come√ßar
const DEFAULT_ITEMS = [
  'Detergente', 'Sab√£o em p√≥', 'Papel higi√™nico', 'Pasta de dente',
  'Arroz', 'Feij√£o', 'A√ß√∫car', 'Sal', '√ìleo', 'Caf√©',
  'Leite', 'P√£o', 'Ovos', 'Manteiga'
];

let items = JSON.parse(localStorage.getItem('estoque-casa') || '[]');
let currentFilter = 'all';

// Se n√£o h√° itens, adiciona os padr√£o
if (items.length === 0) {
  items = DEFAULT_ITEMS.map(name => ({
    id: Date.now() + Math.random(),
    name,
    status: 'temos' // todos come√ßam como "temos"
  }));
  saveItems();
}

function saveItems() {
  localStorage.setItem('estoque-casa', JSON.stringify(items));
}

function showToast(message) {
  const toast = document.getElementById('toast');
  toast.textContent = message;
  toast.classList.add('show');
  setTimeout(() => toast.classList.remove('show'), 2000);
}

function addItem() {
  const input = document.getElementById('newItem');
  const name = input.value.trim();
  
  if (!name) {
    showToast('Digite o nome do item');
    return;
  }
  
  // Verifica se j√° existe
  if (items.some(item => item.name.toLowerCase() === name.toLowerCase())) {
    showToast('Item j√° existe na lista');
    return;
  }
  
  items.push({
    id: Date.now(),
    name,
    status: 'temos'
  });
  
  input.value = '';
  saveItems();
  render();
  showToast(`${name} adicionado`);
}

function toggleStatus(id) {
  const item = items.find(i => i.id === id);
  if (item) {
    item.status = item.status === 'temos' ? 'acabando' : 'temos';
    saveItems();
    render();
    
    const statusText = item.status === 'temos' ? 'Temos' : 'Acabando';
    showToast(`${item.name}: ${statusText}`);
  }
}

function deleteItem(id, event) {
  event.stopPropagation(); // Evita trigger do toggle
  
  const item = items.find(i => i.id === id);
  if (item && confirm(`Remover "${item.name}" da lista?`)) {
    items = items.filter(i => i.id !== id);
    saveItems();
    render();
    showToast(`${item.name} removido`);
  }
}

function setFilter(filter) {
  currentFilter = filter;
  
  // Update filter buttons
  document.querySelectorAll('.filter-btn').forEach(btn => {
    btn.classList.toggle('active', btn.dataset.filter === filter);
  });
  
  render();
}

function render() {
  const list = document.getElementById('itemsList');
  const emptyState = document.getElementById('emptyState');
  
  // Filter items
  let filteredItems = items;
  if (currentFilter === 'acabando') {
    filteredItems = items.filter(item => item.status === 'acabando');
  }
  
  // Sort: acabando first, then alphabetical
  filteredItems.sort((a, b) => {
    if (a.status !== b.status) {
      return a.status === 'acabando' ? -1 : 1;
    }
    return a.name.localeCompare(b.name);
  });
  
  // Update stats
  const temosCount = items.filter(i => i.status === 'temos').length;
  const acabandoCount = items.filter(i => i.status === 'acabando').length;
  
  document.getElementById('temosCount').textContent = temosCount;
  document.getElementById('acabandoCount').textContent = acabandoCount;
  
  // Render items
  if (filteredItems.length === 0) {
    list.style.display = 'none';
    emptyState.style.display = 'block';
    return;
  }
  
  list.style.display = 'grid';
  emptyState.style.display = 'none';
  
  list.innerHTML = filteredItems.map(item => `
    <div class="item ${item.status}" onclick="toggleStatus(${item.id})">
      <div class="item-name">${item.name}</div>
      <div style="display: flex; align-items: center;">
        <span class="item-status status-${item.status}">
          ${item.status === 'temos' ? 'Temos' : 'Acabando'}
        </span>
        <button class="delete-btn" onclick="deleteItem(${item.id}, event)">√ó</button>
      </div>
    </div>
  `).join('');
}

// Event listeners
document.getElementById('addBtn').onclick = addItem;
document.getElementById('newItem').addEventListener('keypress', e => {
  if (e.key === 'Enter') addItem();
});

document.querySelectorAll('.filter-btn').forEach(btn => {
  btn.onclick = () => setFilter(btn.dataset.filter);
});

// Initial render
render();
</script>
</body>
</html>
